{"version":3,"file":"n-sheet.umd.js.map","sources":["ng://n-sheet/lib/n-sheet.service.ts","ng://n-sheet/lib/n-sheet.directive.ts","ng://n-sheet/lib/n-sheet.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { post } from 'selenium-webdriver/http';\nimport { promise } from 'protractor';\n\n@Injectable({\n  providedIn: 'root'\n})\n\nexport class NSheetService {\n\n  constructor(private http: HttpClient) {\n  }\n\n  public getSheet(sheetOptions?, htmlContent?) {\n    return new Promise((resolve, reject) => {\n      if (typeof sheetOptions === 'object') {\n        if (sheetOptions.hasOwnProperty('url')) {\n          delete sheetOptions.retPure;\n          sheetOptions.httpMethod = (sheetOptions.hasOwnProperty('httpMethod') && (sheetOptions.httpMethod.toLowerCase().trim() === 'get' || sheetOptions.httpMethod.toLowerCase().trim() === 'put')) ? sheetOptions.httpMethod.toLowerCase().trim() : 'post';\n          var body = (sheetOptions.httpMethod.toLowerCase().trim() === 'get') ? {} : sheetOptions;\n          this.executeCallback(sheetOptions).then(res => {\n            this.http[sheetOptions.httpMethod.toLowerCase().trim()](sheetOptions.url, body).subscribe(response => {\n              return resolve(response);\n            }, error => {\n              return reject(error);\n            });\n          }).catch(err => {\n            return reject(err);\n          });\n        } else {\n          return reject('No url');\n        }\n      } else if (htmlContent) {\n        return resolve({ excelAsHtml: htmlContent });\n      } else {\n        return reject('Please specify correct values for sheetOptions / htmlContent');\n      }\n    });\n  }\n\n  executeCallback(sheetOptions) {\n    return new Promise((resolve, reject) => {\n      if (sheetOptions.hasOwnProperty('preHttpRequestCallback') && (sheetOptions.preHttpRequestCallback instanceof Promise)) {\n        sheetOptions.preHttpRequestCallback.then(res => {\n          return resolve();\n        }).catch(err => {\n          return reject('Promise function returned a reject');\n        });\n      } else if (sheetOptions.hasOwnProperty('preHttpRequestCallback') && (typeof sheetOptions.preHttpRequestCallback === 'boolean')) { \n        if(sheetOptions.preHttpRequestCallback === true) {\n          return resolve(); \n        } else {\n          return reject('Boolean function returned a false');\n        }\n      } else if (sheetOptions.hasOwnProperty('preHttpRequestCallback') && (typeof sheetOptions.preHttpRequestCallback === 'function')) { \n          if(sheetOptions.preHttpRequestCallback() === true) {\n            return resolve(); \n          } else {\n            return reject('Callback function either returned a false or did not return a boolean value');\n          }\n      } else {\n        return resolve();\n      }\n    });\n  }\n\n}","import { Directive, Input, Output, EventEmitter, OnInit, ElementRef } from '@angular/core';\nimport { NSheetService } from './n-sheet.service';\nimport { HttpClient } from '@angular/common/http';\n\n\n@Directive({\n  selector: '[n-sheet]'\n})\nexport class NSheetDirective implements OnInit {\n  @Input() sheetOptions;\n  @Input() htmlContent;\n  @Output() onsuccess: EventEmitter<any> = new EventEmitter();\n  @Output() onerror: EventEmitter<any> = new EventEmitter();\n\n  constructor(private sheetService: NSheetService, private http: HttpClient, private el: ElementRef) { }\n\n  ngOnInit() {\n    this.getSheet()\n    .then(success => this.onsuccess.emit(success))\n    .catch(error => this.onerror.emit(error));\n   }\n\n  getSheet(): Promise<any> {\n    return new Promise((resolve, reject) => {\n      this.sheetService.getSheet(this.sheetOptions,this.htmlContent).then(res => {\n        if(res.hasOwnProperty('excelAsHtml') && res['excelAsHtml'].length > 0 && !Array.isArray(res['excelAsHtml'])) {\n          if(!(typeof this.sheetOptions === 'object' && this.sheetOptions.hasOwnProperty('doAppend') && this.sheetOptions.doAppend === true)) {\n            this.el.nativeElement.innerHTML = \"\";\n          }\n          const fragment = document.createRange().createContextualFragment(res['excelAsHtml']);\n          this.el.nativeElement.appendChild(fragment);\n          return resolve(res);\n        } else {\n          return reject(res);\n        }\n      }).catch(err => reject(err));\n    });\n  }\n\n}","import { NgModule } from '@angular/core';\nimport { NSheetDirective } from './n-sheet.directive';\nimport { HttpClientModule } from '@angular/common/http';\n\n@NgModule({\n  declarations: [NSheetDirective],\n  imports: [HttpClientModule \n  ],\n  exports: [NSheetDirective]\n})\nexport class NSheetModule { }\n"],"names":["Injectable","HttpClient","EventEmitter","Directive","ElementRef","Input","Output","NgModule","HttpClientModule"],"mappings":"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"}
