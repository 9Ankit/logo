!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("n-sheet",["exports","@angular/core","@angular/common/http"],t):t(e["n-sheet"]={},e.ng.core,e.ng.common.http)}(this,function(e,r,t){"use strict";var n=function(){function e(e){this.http=e}return e.prototype.getSheet=function(o,e){var c=this;return new Promise(function(t,n){if("object"!=typeof o)return e?t({excelAsHtml:e}):n("Please specify correct values for sheetOptions / htmlContent");if(!o.hasOwnProperty("url"))return n("No url");delete o.retPure,o.httpMethod=!o.hasOwnProperty("httpMethod")||"get"!==o.httpMethod.toLowerCase().trim()&&"put"!==o.httpMethod.toLowerCase().trim()?"post":o.httpMethod.toLowerCase().trim();var r="get"===o.httpMethod.toLowerCase().trim()?{}:o;c.executeCallback(o).then(function(e){c.http[o.httpMethod.toLowerCase().trim()](o.url,r).subscribe(function(e){return t(e)},function(e){return n(e)})})["catch"](function(e){return n(e)})})},e.prototype.executeCallback=function(e){return new Promise(function(t,n){if(!(e.hasOwnProperty("preHttpRequestCallback")&&e.preHttpRequestCallback instanceof Promise))return e.hasOwnProperty("preHttpRequestCallback")&&"boolean"==typeof e.preHttpRequestCallback?!0===e.preHttpRequestCallback?t():n("Boolean function returned a false"):e.hasOwnProperty("preHttpRequestCallback")&&"function"==typeof e.preHttpRequestCallback?!0===e.preHttpRequestCallback()?t():n("Callback function either returned a false or did not return a boolean value"):t();e.preHttpRequestCallback.then(function(e){return t()})["catch"](function(e){return n("Promise function returned a reject")})})},e.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:t.HttpClient}]},e.ngInjectableDef=r.defineInjectable({factory:function(){return new e(r.inject(t.HttpClient))},token:e,providedIn:"root"}),e}(),o=function(){function e(e,t,n){this.sheetService=e,this.http=t,this.el=n,this.onsuccess=new r.EventEmitter,this.onerror=new r.EventEmitter}return e.prototype.ngOnInit=function(){var t=this;this.getSheet().then(function(e){return t.onsuccess.emit(e)})["catch"](function(e){return t.onerror.emit(e)})},e.prototype.getSheet=function(){var o=this;return new Promise(function(n,r){o.sheetService.getSheet(o.sheetOptions,o.htmlContent).then(function(e){if(e.hasOwnProperty("excelAsHtml")&&0<e.excelAsHtml.length&&!Array.isArray(e.excelAsHtml)){"object"==typeof o.sheetOptions&&o.sheetOptions.hasOwnProperty("doAppend")&&!0===o.sheetOptions.doAppend||(o.el.nativeElement.innerHTML="");var t=document.createRange().createContextualFragment(e.excelAsHtml);return o.el.nativeElement.appendChild(t),n(e)}return r(e)})["catch"](function(e){return r(e)})})},e.decorators=[{type:r.Directive,args:[{selector:"[n-sheet]"}]}],e.ctorParameters=function(){return[{type:n},{type:t.HttpClient},{type:r.ElementRef}]},e.propDecorators={sheetOptions:[{type:r.Input}],htmlContent:[{type:r.Input}],onsuccess:[{type:r.Output}],onerror:[{type:r.Output}]},e}(),c=function(){function e(){}return e.decorators=[{type:r.NgModule,args:[{declarations:[o],imports:[t.HttpClientModule],exports:[o]}]}],e}();e.NSheetService=n,e.NSheetDirective=o,e.NSheetModule=c,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=n-sheet.umd.min.js.map