{"version":3,"file":"n-sheet.js.map","sources":["ng://n-sheet/lib/n-sheet.service.ts","ng://n-sheet/lib/n-sheet.directive.ts","ng://n-sheet/lib/n-sheet.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { post } from 'selenium-webdriver/http';\nimport { promise } from 'protractor';\n\n@Injectable({\n  providedIn: 'root'\n})\n\nexport class NSheetService {\n\n  constructor(private http: HttpClient) {\n  }\n\n  public getSheet(sheetOptions?, htmlContent?) {\n    return new Promise((resolve, reject) => {\n      if (typeof sheetOptions === 'object') {\n        if (sheetOptions.hasOwnProperty('url')) {\n          delete sheetOptions.retPure;\n          sheetOptions.httpMethod = (sheetOptions.hasOwnProperty('httpMethod') && (sheetOptions.httpMethod.toLowerCase().trim() === 'get' || sheetOptions.httpMethod.toLowerCase().trim() === 'put')) ? sheetOptions.httpMethod.toLowerCase().trim() : 'post';\n          var body = (sheetOptions.httpMethod.toLowerCase().trim() === 'get') ? {} : sheetOptions;\n          this.executeCallback(sheetOptions).then(res => {\n            this.http[sheetOptions.httpMethod.toLowerCase().trim()](sheetOptions.url, body).subscribe(response => {\n              return resolve(response);\n            }, error => {\n              return reject(error);\n            });\n          }).catch(err => {\n            return reject(err);\n          });\n        } else {\n          return reject('No url');\n        }\n      } else if (htmlContent) {\n        return resolve({ excelAsHtml: htmlContent });\n      } else {\n        return reject('Please specify correct values for sheetOptions / htmlContent');\n      }\n    });\n  }\n\n  executeCallback(sheetOptions) {\n    return new Promise((resolve, reject) => {\n      if (sheetOptions.hasOwnProperty('preHttpRequestCallback') && (sheetOptions.preHttpRequestCallback instanceof Promise)) {\n        sheetOptions.preHttpRequestCallback.then(res => {\n          return resolve();\n        }).catch(err => {\n          return reject('Promise function returned a reject');\n        });\n      } else if (sheetOptions.hasOwnProperty('preHttpRequestCallback') && (typeof sheetOptions.preHttpRequestCallback === 'boolean')) { \n        if(sheetOptions.preHttpRequestCallback === true) {\n          return resolve(); \n        } else {\n          return reject('Boolean function returned a false');\n        }\n      } else if (sheetOptions.hasOwnProperty('preHttpRequestCallback') && (typeof sheetOptions.preHttpRequestCallback === 'function')) { \n          if(sheetOptions.preHttpRequestCallback() === true) {\n            return resolve(); \n          } else {\n            return reject('Callback function either returned a false or did not return a boolean value');\n          }\n      } else {\n        return resolve();\n      }\n    });\n  }\n\n}","import { Directive, Input, Output, EventEmitter, OnInit, ElementRef } from '@angular/core';\nimport { NSheetService } from './n-sheet.service';\nimport { HttpClient } from '@angular/common/http';\n\n\n@Directive({\n  selector: '[n-sheet]'\n})\nexport class NSheetDirective implements OnInit {\n  @Input() sheetOptions;\n  @Input() htmlContent;\n  @Output() onsuccess: EventEmitter<any> = new EventEmitter();\n  @Output() onerror: EventEmitter<any> = new EventEmitter();\n\n  constructor(private sheetService: NSheetService, private http: HttpClient, private el: ElementRef) { }\n\n  ngOnInit() {\n    this.getSheet()\n    .then(success => this.onsuccess.emit(success))\n    .catch(error => this.onerror.emit(error));\n   }\n\n  getSheet(): Promise<any> {\n    return new Promise((resolve, reject) => {\n      this.sheetService.getSheet(this.sheetOptions,this.htmlContent).then(res => {\n        if(res.hasOwnProperty('excelAsHtml') && res['excelAsHtml'].length > 0 && !Array.isArray(res['excelAsHtml'])) {\n          if(!(typeof this.sheetOptions === 'object' && this.sheetOptions.hasOwnProperty('doAppend') && this.sheetOptions.doAppend === true)) {\n            this.el.nativeElement.innerHTML = \"\";\n          }\n          const fragment = document.createRange().createContextualFragment(res['excelAsHtml']);\n          this.el.nativeElement.appendChild(fragment);\n          return resolve(res);\n        } else {\n          return reject(res);\n        }\n      }).catch(err => reject(err));\n    });\n  }\n\n}","import { NgModule } from '@angular/core';\nimport { NSheetDirective } from './n-sheet.directive';\nimport { HttpClientModule } from '@angular/common/http';\n\n@NgModule({\n  declarations: [NSheetDirective],\n  imports: [HttpClientModule \n  ],\n  exports: [NSheetDirective]\n})\nexport class NSheetModule { }\n"],"names":[],"mappings":"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"}
